<html>
    <head>
        <link rel="stylesheet" href="../bower_components/CSS-Playing-Cards/cards.css"/>
        <style>

            body{
                margin: 0;
            }

            #container{
                width : 800px;
                margin: 0 auto;
                position: relative;
                top: 17.5%;
            }

            .matched{
                color: gray!important;
                background-color: gray!important;
            }

            .playerBar{

                position: absolute;
                bottom: 0;
                width: 100%;
                height: 20%;
            }

            .playerBar:first-of-type{
                top:0;
            }

        </style>
    </head>
    <body>

        <div id="player1bar" class="playerBar">
                <span class="playerIDSpan">
                    PLAYER 1
                </span>
                <span id="player1points" class="playerPointsSpan">
            
                </span>
            </div>
            <div id="player2bar" class="playerBar">
                <span class="playerIDSpan">
                    PLAYER 2
                </span>
                <span id="player2points" class="playerPointsSpan">
            
                </span>
            </div>

        <div id="container" class="playingCards fourColours simpleCards">
        </div>
        
        <script src="../bower_components/jquery/dist/jquery.min.js"></script>
        <script>
            var turnCounter = 0;
            var turnSelections = [];
            var playerTurn = 0;
            var players = [0,0];
            var timer = 5;
            function shuffle(array) {
                var currentIndex = array.length, temporaryValue, randomIndex;

                // While there remain elements to shuffle...
                while (0 !== currentIndex) {

                    // Pick a remaining element...
                    randomIndex = Math.floor(Math.random() * currentIndex);
                    currentIndex -= 1;

                    // And swap it with the current element.
                    temporaryValue = array[currentIndex];
                    array[currentIndex] = array[randomIndex];
                    array[randomIndex] = temporaryValue;
                }

                return array;
            }
            var ranks = ['a', '2','3','4','5','6','7','8','9','10','j','q','k'];
            var suits = ['diams','hearts','spades','clubs'];
            var cards = [];
            $.each(ranks, function(index, rank) {
                var val = (index+1)*4-4;
                $.each(suits, function(index, suit){

                    var card = {};
                    var $el = document.createElement('div');
                    $($el).addClass("card rank-"+rank+" "+suit+" back");
                    $el.innerHTML = "<div class='rank'>"+rank+"</div><div class='suit'>&"+suit+";</div>";
                    val++;
                    card.place = val;
                    card.$el = $el;
                    card.rank = rank;
                    card.suit = suit;
                    card.flipable = true;
                    $el.card = card;
                    cards.push(card);
                    cards = shuffle(cards);
                    $.each(cards, function( index, card ){
                        $("#container").append(card.$el);
                    })

                    $($el).click( function(){
                        if($el.card.flipable === false){
                            return;
                        }
                        $el.card.flipable = !$el.card.flipable;
                        $($el).toggleClass("back");
                        turnSelections.push($el);
                        turnCounter++;
                        if(turnCounter == 2){
                            if(turnSelections[0].card.rank === turnSelections[1].card.rank){
                                players[playerTurn]++;
                                console.log(turnSelections);
                                $.each(turnSelections, function(index, card){
                                    
                                        card.className = '';
                                        $(card).toggleClass("card");
                                        $(card).attr('style','color: #fff!important; background-color: #fff!important');
                                        $(card).prop('onclick',null).off('click');
                                        console.log(card);
                                });
                                console.log(playerTurn);
                                console.log(players[playerTurn]);
                            }else{
                               $.each(turnSelections, function(index, card){
                                        $(card).delay(1000).queue(function(next){
                                            card.card.flipable = true;
                                            $(this).toggleClass("back");
                                            next();
                                        });
                                        console.log(card);
                                });
                            }
                            turnCounter = 0;
                            playerTurn = (playerTurn == 0)? 1 :0;
                            turnSelections = [];
                        }
                    });
                });
            });
        </script>
    </body>
</html>